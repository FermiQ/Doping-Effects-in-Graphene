      PROGRAM TRANSFERMATIXTWO
      IMPLICIT NONE

      DOUBLE PRECISION CHECKUNI
      EXTERNAL CHECKUNI
      DOUBLE PRECISION CHECKUNI2
      EXTERNAL CHECKUNI2
      DOUBLE PRECISION CHECKUNI3
      EXTERNAL CHECKUNI3
      DOUBLE PRECISION CONDUCTANCE
      EXTERNAL CONDUCTANCE
c$$   NB LIMX CHANGED TO 2       
      INTEGER, PARAMETER :: LIMX=2, WRAPY=0, WRAPX=0,
     + MSIZE=4*LIMX*LIMX, M2SIZE=LIMX*LIMX
      INTEGER I/1/, K/1/, F/1/,LIMY/10/
      CHARACTER*3 VALUE
      
      DOUBLE PRECISION TVALS(LIMX)

      DOUBLE PRECISION COND/-1.0/, FLUX/0.0/, E/-3/, G, DLVAL
      DOUBLE COMPLEX   ZEROC/0.0/, ONEC/1.0/
      
      DOUBLE COMPLEX T(LIMX, LIMX),    TTILDE(LIMX, LIMX),
     +               R(LIMX, LIMX),    RTILDE(LIMX, LIMX)
      DOUBLE COMPLEX O(2 *LIMX, 2*LIMX), IO(2*LIMX, 2*LIMX)

      DATA  O/MSIZE*0.0/, IO/MSIZE*0.0/

C$$$  READS COMMAND LINE ARGUMENT AS LIMY
c      CALL GETARG(1, VALUE)
c      READ(UNIT=VALUE, FMT=*) LIMY

      CALL FILLOANDINVERT(O, IO, LIMX, FLUX)
      DO F = 1, 1201

         CALL GETTRANS(TVALS, LIMX, LIMY, O, IO,
     +    T, R, TTILDE, RTILDE, E, FLUX, WRAPX)
    
C$$$  ERROR RETURN TYPE MISMATCH OF FUNCTION CHECKUNI REAL(4)/REAL(8)      
      COND = CHECKUNI(LIMX,T,R,TTILDE,RTILDE)
      G    = CONDUCTANCE (TVALS, LIMX)

c$$$  WRITES ENERGY, CONDUCTANCE, UNITARITY
      WRITE(*,50) E, G, COND
  
c      WRITE(*,60) E,(TVALS(I)*TVALS(I), I = 1, LIMX)

c$$$ 'E' STEPS CONSISTANT WITH ANALYTICAL.C
      E=E+0.005
      END DO

 50   FORMAT (F8.5,15ES15.5E3)      
 60   FORMAT (15ES15.5E3)
     

      STOP
      END
